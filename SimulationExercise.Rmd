---
Title: "Simulation of an Exponential Distribution and the Central Limit Theorem"
Author: "Manuel A. Cerda R."
Date: "31 de July de 2016"
Output: html_document
---

#Overview

This simulation investigates the exponential distribution in R and compares it with the Central Limit Theorem. The exponential distribution is simulated in R wirh rexp(n, lambda) where lambda is the rate parameter. The mean of exponential distribution is 1/lambda and the standard deviation is also 1/lambda where lambda = 0.2 for all of the simulations. The distribution of averages is based upon 40 exponentials. And, a total of a 1000 simulations are considered.


###Content

1. Simulations
2. Sample Mean versus Theoretical Mean
3. Sample Variance versus Theoretical Variance
4. Distributions


###Simulations

```{r sampling, echo=TRUE}
library(knitr)
library(ggplot2)

# setting the random generator seed to ensure replicable steps
set.seed(1234);

# declaring known variables 
lambda <- 0.2
t_mean <- 1/lambda
n <- 40
n_sim <- 1000

# generating n=40 random exponentials
my_rexp <- function() { rexp(n, rate = lambda) }
summary(my_rexp())

# generating the 1000 simulated trials
simTrials <- data.frame(values=replicate(n_sim, mean(my_rexp() )))
summary(simTrials$values)

# calculating cumputable variables
s_mean <- mean(simTrials$values)
t_sd <- t_mean * 1 / sqrt(n)
s_sd <- sd(simTrials$values)
s_var <- var(simTrials$values)
t_var <- t_sd^2
```


###Sample Mean versus Theoretical Mean

```{r smean_tmean, echo=TRUE}
# Random Exponential Distribution
h <- hist(simTrials$values, freq= T, ylab= "Frequency", xlab="Random Exponential", main="Random Exponential Distribution", col=rgb(1, 1, 1, 0.25))
abline(v = t_mean, col="red", lwd = 2, lty = 1)
abline(v = s_mean, col="blue", lwd = 2, lty = 1)
```

The Sample Mean is close enough to the Theoretical Mean.

###Sample Variance versus Theoretical Variance

```{r svar_tvar, echo=TRUE, warning=FALSE}
# Random Exponential Distribution
t_density <- density(dnorm(simTrials$values, mean = t_mean, sd= t_sd), kernel="gaussian")
plot(t_density$x, t_density$y, col = "pink", type="l", xlab="Random Exponential", ylab="Density", axes=F)

s_density <- density(dnorm(simTrials$values, mean = s_mean, sd= s_sd), kernel="gaussian")
lines(s_density$x, s_density$y, col = "black")

abline(v = t_var/2, col="red", lwd = 1, lty = 2)
abline(v = s_var/2, col="blue", lwd = 1, lty = 2)

```

The difference between the Sample Variance and the Theoretical Variance is remarquable in variability of the exponentials as they accumulate around the.


###Distributions

```{r distribution, echo=TRUE, warning=FALSE}
seq40 <- runif(1000, min=0, max=40)
g_dnorm <- dnorm(seq40, mean= mean(seq40), sd= sd(seq40))
s_dnorm <- dnorm(simTrials$values, mean = s_mean, sd= s_sd)

plot(sort(g_dnorm), col = "orange", type="l", xlab="Random Exponential", ylab="Density")

hg <- hist(g_dnorm, plot = F)
abline(v = max(hg$counts), col = "orange")

hs <- hist(s_dnorm, plot = F)
abline(v = max(hs$counts), col = "blue")

ht <- hist(dnorm(sort(simTrials$values), mean = t_mean, sd= t_sd), plot = F)
abline(v = max(ht$counts), col = "red")
```